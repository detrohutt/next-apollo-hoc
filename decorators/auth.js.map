{"version":3,"sources":["../src/decorators/auth.js"],"names":["ComposedComponent","opts","add","auth","get","WithAuth","Component","getInitialProps","ctx","composedInitialProps","render","props","childProps","login","logout","displayName","decorator","mutation","name"],"mappings":";;;;;;;;AAAA;;;;AACA;;AAEA;;;;AACA;;;;AAEA;;;;AACA;;;;kBAEe,6BAAa,CAACA,iBAAD,EAAoBC,IAApB,KAA6B;AACvD,mBAAOC,GAAP,CAAW,EAAEC,MAAMF,IAAR,EAAX;AACAA,SAAO,iBAAOG,GAAP,GAAaD,IAApB;;AAEA,QAAME,QAAN,SAAuB,gBAAMC,SAA7B,CAAuC;;AAKrC,iBAAaC,eAAb,CAA6BC,GAA7B,EAAkC;AAChC,UAAIC,uBAAuB,EAA3B;AACA,UAAIT,kBAAkBO,eAAtB,EAAuC;AACrCE,+BAAuB,MAAMT,kBAAkBO,eAAlB,CAAkCC,GAAlC,CAA7B;AACD;;AAED,0BACKC,oBADL;AAGD;;AAEDC,aAAS;AACP,UAAIC,QAAQ,KAAKA,KAAjB;AACA,UAAIC,aAAa;AACfC,8BADe;AAEfC;AAFe,OAAjB;;AAKA,aACE,8BAAC,iBAAD,eAAuBH,KAAvB,EAAkCC,UAAlC,EADF;AAGD;AA1BoC;;AAAjCP,UAJiD,CAK9CU,WAL8C,GAK/B,YAAW,wCAC/Bf,iBAD+B,CAE/B,GAPmD;AAiCvD,MAAIgB,YAAYX,QAAhB;AACA,MAAIJ,KAAKY,KAAL,IAAcZ,KAAKY,KAAL,CAAWI,QAA7B,EACED,YAAY,0BAAQf,KAAKY,KAAL,CAAWI,QAAnB,EAA6B;AACvCC,UAAM;AADiC,GAA7B,EAETF,SAFS,CAAZ;;AAIF,SAAOA,SAAP;AACD,CAxCc,C","file":"auth.js","sourcesContent":["import React from 'react'\nimport { graphql } from 'react-apollo'\n\nimport login from '../lib/login'\nimport logout from '../lib/logout'\n\nimport config from '../config'\nimport { getDecorator, getComponentDisplayName } from '../lib/component'\n\nexport default getDecorator((ComposedComponent, opts) => {\n  config.add({ auth: opts })\n  opts = config.get().auth\n\n  class WithAuth extends React.Component {\n    static displayName = `WithAuth(${getComponentDisplayName(\n      ComposedComponent\n    )})`\n\n    static async getInitialProps(ctx) {\n      let composedInitialProps = {}\n      if (ComposedComponent.getInitialProps) {\n        composedInitialProps = await ComposedComponent.getInitialProps(ctx)\n      }\n\n      return {\n        ...composedInitialProps\n      }\n    }\n\n    render() {\n      let props = this.props\n      let childProps = {\n        login,\n        logout\n      }\n\n      return (\n        <ComposedComponent {...props} {...childProps} />\n      )\n    }\n  }\n\n  let decorator = WithAuth\n  if (opts.login && opts.login.mutation)\n    decorator = graphql(opts.login.mutation, {\n      name: 'loginMutation'\n    })(decorator)\n\n  return decorator\n})\n"]}